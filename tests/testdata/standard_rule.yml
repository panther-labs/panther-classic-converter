from unittest import TestCase

class TestEnrichedEvent(TestCase):
  def test_udm_missing_key(self) -> None:
    event = {'dst_ip': '1.1.1.1', 'dst_port': '2222'}
    data_model = DataModel(
    {
      'body': 'def get_source_ip(event):\n\treturn None',
      'versionId': 'version',
      'mappings': [{
        'name': 'destination_ip',
        'path': 'dst_ip'
      }, {
        'name': 'source_ip',
        'method': 'get_source_ip'
      }],
      'id': 'data_model_id'
    }
    )
    enriched_event = PantherEvent(event, data_model)
    self.assertEqual(enriched_event.udm('missing_key'), None)